
<!DOCTYPE html>
<html>
<head>
    <title>Options Monitor</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .container { display: flex; justify-content: space-between; }
        .table-container { width: 48%; }
        table { width: 100%; border-collapse: collapse; margin: 10px 0; }
        th, td { padding: 8px; border: 1px solid #ddd; text-align: right; }
        th { background-color: #f5f5f5; }
        .positive { color: green; }
        .negative { color: red; }
        .depth-table { font-size: 0.9em; margin-top: 5px; }
        .timestamp { text-align: center; margin: 10px 0; }
    </style>
    <script>
        function refreshData() {
            fetch('/update')
                .then(response => response.json())
                .then(data => {
                    updateTable('ce-table', data.ce_options);
                    updateTable('pe-table', data.pe_options);
                    document.getElementById('timestamp').textContent = data.timestamp;
                });
        }
        
        function updateTable(tableId, data) {
            const tbody = document.getElementById(tableId).getElementsByTagName('tbody')[0];
            tbody.innerHTML = '';
            
            for (const [symbol, option] of Object.entries(data)) {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${symbol}</td>
                    <td class="${option.change >= 0 ? 'positive' : 'negative'}">
                        ${option.ltp.toFixed(2)}
                    </td>
                    <td class="${option.change >= 0 ? 'positive' : 'negative'}">
                        ${option.change.toFixed(2)}%
                    </td>
                    <td>${option.volume.toLocaleString()}</td>
                    <td>${option.oi.toLocaleString()}</td>
                    <td>
                        <table class="depth-table">
                            <tr><th>Bid Qty</th><th>Bid</th><th>Ask</th><th>Ask Qty</th></tr>
                            ${option.depth.bids.map((bid, i) => `
                                <tr>
                                    <td>${bid.qty}</td>
                                    <td>${bid.price}</td>
                                    <td>${option.depth.asks[i].price}</td>
                                    <td>${option.depth.asks[i].qty}</td>
                                </tr>
                            `).join('')}
                        </table>
                    </td>
                `;
            }
        }
        
        setInterval(refreshData, 2000);
    </script>
</head>
<body>
    <div class="timestamp">Last Updated: <span id="timestamp">2025-09-26 16:11:37</span></div>
    <div class="container">
        <div class="table-container">
            <h2>Call Options (CE)</h2>
            <table id="ce-table">
                <thead>
                    <tr>
                        <th>Symbol</th>
                        <th>LTP</th>
                        <th>Change%</th>
                        <th>Volume</th>
                        <th>OI</th>
                        <th>Market Depth</th>
                    </tr>
                </thead>
                <tbody>
                
                </tbody>
            </table>
        </div>
        
        <div class="table-container">
            <h2>Put Options (PE)</h2>
            <table id="pe-table">
                <thead>
                    <tr>
                        <th>Symbol</th>
                        <th>LTP</th>
                        <th>Change%</th>
                        <th>Volume</th>
                        <th>OI</th>
                        <th>Market Depth</th>
                    </tr>
                </thead>
                <tbody>
                
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>
        